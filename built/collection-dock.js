//     collection-dock
//     (c) simonfan
//     collection-dock is licensed under the MIT terms.

define("__collection-dock/attach",["require","exports","module","lodash"],function(e,t){e("lodash");t.resortEvent="resort",t.attach=function(e){this.detach(),this.collection=e,e.on("add",this.handleAdd).on("remove",this.handleRemove).on("reset",this.handleReset).on(this.resortEvent,this.handleResort),this.handleReset(e)},t.detach=function(){this.collection&&this.collection.off("add",void 0,this).off("remove",void 0,this).off("reset",void 0,this).off(this.resortEvent,void 0,this),this.$container.html("")}}),define("__collection-dock/views-proxy",["require","exports","module","lodash"],function(e,t){var i=e("lodash");t.on=function(){var e=Array.prototype.slice.call(arguments);return i.each(this.itemViews,function(t){t.on.apply(t,e)}),this}}),define("__collection-dock/event-handlers",["require","exports","module","lodash","jquery","q"],function(e,t){e("lodash"),e("jquery"),e("q");t.handleAdd=function(e){var t=this.buildItemView({model:e});this.storeView(e,t)},t.handleRemove=function(e){var t=this.getView(e);t&&t.remove()},t.handleReset=function(){this.$container.html(""),this.collection.each(this.handleRemove),this.collection.each(this.handleAdd)},t.handleResort=function(e){this.handleReset(e,this.$container)}}),define("__collection-dock/item/view",["require","exports","module","model-dock","jquery"],function(e,t,i){var o=e("model-dock"),n=e("jquery");i.exports=o.extend({initialize:function(e){this.collectionView=e.collectionView,o.prototype.initialize.apply(this,arguments)},html:"<div></div>",render:function(){var e=this.collectionView.collection.indexOf(this.model);this.$el=n(this.html);var t=this.collectionView.getViewAt(e-1);t?this.$el.insertAfter(t.$el):this.$el.appendTo(this.collectionView.$container)},remove:function(){this.collectionView.removeView(this.model.cid),o.prototype.remove.apply(this,arguments)}})}),define("__collection-dock/item/methods",["require","exports","module","lodash","q","./view"],function(e,t){{var i=e("lodash");e("q")}t.buildItemView=function(e){return e.collectionView=this,this.itemView(e)},t.itemView=e("./view"),t.getViewAt=function(e){if(e>=0){var t=this.collection.at(e);return this.getView(t.cid)}},t.storeView=function(e,t){return e=i.isObject(e)?e.cid:e,this.itemViews[e]=t,this},t.getView=function(e){return e=i.isObject(e)?e.cid:e,this.itemViews[e]},t.removeView=function(e){return e=i.isObject(e)?e.cid:e,delete this.itemViews[e],this}}),define("collection-dock",["require","exports","module","lodash","lowercase-backbone","./__collection-dock/attach","./__collection-dock/views-proxy","./__collection-dock/event-handlers","./__collection-dock/item/methods"],function(e,t,i){var o=e("lodash"),n=e("lowercase-backbone"),c=i.exports=n.view.extend(function(e){if(n.view.prototype.initialize.apply(this,arguments),o.extend(this,e),!this.$el)throw new Error('No "$el" property found on dock.');var t=this.$container;this.$container=t?o.isString(t)?this.$el.find(t):t:this.$el,o.bindAll(this,"handleAdd","handleRemove","handleReset","handleResort"),this.itemViews={}});c.proto(e("./__collection-dock/attach")),c.proto(e("./__collection-dock/views-proxy")),c.proto(e("./__collection-dock/event-handlers")),c.proto(e("./__collection-dock/item/methods"))});